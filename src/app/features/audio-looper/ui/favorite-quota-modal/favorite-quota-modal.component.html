@if (isOpen()) {
  <!-- Backdrop -->
  <div class="modal-backdrop" (click)="closeModal()"></div>

  <!-- Modal -->
  <div class="modal-container" role="dialog" aria-modal="true" aria-labelledby="modal-title">
    <div class="modal-header">
      <h2 id="modal-title" class="modal-title">Limite de favoris atteinte</h2>
      <button class="modal-close-btn" (click)="closeModal()" type="button" aria-label="Fermer">
        <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M18 6L6 18M6 6L18 18" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
        </svg>
      </button>
    </div>

    <div class="modal-body">
      <p class="modal-message">
        Vous avez atteint la limite de <strong>10 favoris</strong>. Supprimez un favori pour lib√©rer de l'espace et ajouter le nouveau fichier.
      </p>

      <div class="favorites-list">
        @for (favorite of favorites(); track favorite.id) {
          <div class="favorite-item">
            <div class="favorite-info">
              <div class="favorite-header">
                <h3 class="favorite-name">{{ favorite.fileName }}</h3>
                <span class="favorite-size">{{ formatSize(favorite.size) }}</span>
              </div>
              <div class="favorite-meta">
                <span class="favorite-duration">
                  <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
                    <path d="M12 6V12L16 14" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                  </svg>
                  {{ formatDuration(favorite.duration) }}
                </span>
                <span class="favorite-date">
                  <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <rect x="3" y="4" width="18" height="18" rx="2" stroke="currentColor" stroke-width="2"/>
                    <path d="M16 2V6M8 2V6M3 10H21" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                  </svg>
                  {{ formatDate(favorite.timestamp) }}
                </span>
              </div>
            </div>

            <button
              class="favorite-delete-btn"
              (click)="deleteFavorite(favorite.id)"
              [disabled]="isDeleting() === favorite.id"
              type="button"
              [attr.aria-label]="'Supprimer ' + favorite.fileName"
            >
              @if (isDeleting() === favorite.id) {
                <span class="spinner"></span>
              } @else {
                <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M3 6H5H21M19 6V20C19 21.1 18.1 22 17 22H7C5.9 22 5 21.1 5 20V6M8 6V4C8 2.9 8.9 2 10 2H14C15.1 2 16 2.9 16 4V6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                  <path d="M10 11V17M14 11V17" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                </svg>
                Supprimer
              }
            </button>
          </div>
        } @empty {
          <p class="empty-message">Aucun favori disponible</p>
        }
      </div>
    </div>

    <div class="modal-footer">
      <button class="modal-cancel-btn" (click)="closeModal()" type="button">
        Annuler
      </button>
    </div>
  </div>
}
